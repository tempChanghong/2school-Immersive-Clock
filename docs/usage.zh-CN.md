# 使用说明（中文）

本文档详细介绍沉浸式时钟的各项功能、操作步骤与注意事项。请配合主界面 HUD 与设置面板进行操作。

## 目录

- 快速上手
- 模式切换与 HUD
- 倒计时
- 秒表
- 自习模式
- 设置面板
- 天气
- 噪音监测与报告
- 励志语录与频道管理
- 课程表管理
- PWA 安装与离线
- 常见问题（简要）

## 快速上手

- 打开页面后，点击任意空白处或按下 `Space / Enter` 显示 HUD。
- 在 HUD 中选择模式：时钟、倒计时、秒表、自习。
- HUD 约在 8 秒后自动隐藏，再次点击或按键可重新唤出。

## 模式切换与 HUD

- 在任何页面点击空白区域或按下 `Space / Enter` 唤出 HUD。
- HUD 提供模式切换、作者信息、设置按钮等入口。
- 无障碍：HUD 带有语义化 `role` 与标题描述，适合键盘操作。

## 倒计时

- 双击时间显示（或在触摸设备进行双击）打开倒计时设置。
- 设置小时、分钟、秒，或从预设中一键选择（10 分钟、30 分钟、1 小时、1 小时 15 分、2 小时）。
- 键盘操作：`Enter` 确认并开始，`Esc` 退出设置。
- 音效：最后 5 秒逐秒提示（`public/ding-1.mp3`），结束播放终止音（`public/ding.mp3`）。
- 颜色与可见性：遵循全局视觉一致性，数字常态显示为白色。

## 秒表

- 在 HUD 选择“秒表”进入秒表模式。
- 提供启动、暂停与累计时长展示，界面简洁直观。

## 自习模式

- 左上角：噪音监测（需浏览器授权麦克风）。
- 右上角：目标年份或自定义事件倒计时与励志语录展示。
- 中央：当前时间与日期大字显示，适合投屏与课堂场景。
- 报告：在课时结束前自动生成噪音报告，可手动关闭或查看历史记录。

## 设置面板

- 在自习模式下点击设置按钮打开设置面板。
- 基础设置：
  - 倒计时类型：高考年份倒计时或自定义事件（名称与日期）。
  - 目标年份范围：从当前年起至未来 10 年。
- 天气设置：
  - 手动刷新天气；显示城市、温度、湿度、风向风力等信息。
  - 数据源优先级：浏览器 Geolocation → 高德 IP → 其他 IP 源；主要天气来源：和风天气。
- 噪音设置：
  - 麦克风校准与基线滑动调整。
  - 自动弹出报告开关（默认开启），持久化保存偏好。
- 语录设置：
  - 渠道管理（保留文学、诗词、哲学、抖机灵）；刷新间隔可自定义。
- 课程表：
  - 添加/编辑/删除课时段，支持本地持久化保存。

## 天气

- 天气展示组件支持城市定位与多项实时天气参数显示。
- 若浏览器不授权定位，将自动回退至 IP 定位或其他来源。
- 设置面板可手动刷新以获取最新天气。

## 噪音监测与报告

- 需授权麦克风访问；打开后显示当前噪音水平与状态提示。
- 在课时结束前生成统计报告：平均值、峰值、提醒次数、吵闹时长等。
- 历史记录可在弹窗中查看，支持左右栏独立滚动与图表阈值线。

### 为什么“显示基准”与“校准”要结合？

在不同设备与环境下，麦克风原始信号的幅度差异很大。校准步骤会采样约 3 秒并计算 RMS（有效值），这是设备层面的物理量。而“显示基准”滑块用于把这个 RMS 映射为可阅读的分贝显示（呈现层）。两者结合后，可以在不同设备上得到稳定且可比较的分贝读数：

- 先通过校准获取当前设备的 RMS 基线；
- 再用“显示基准”设定映射的参考值，使显示更符合你的场景与感知；
- 当已存在 RMS 校准时，调整“显示基准”会同步更新当前基准显示，便于快速微调。

这样既保留了测量的可靠性（校准），又提供了符合使用习惯的呈现（显示基准），降低首次使用的学习成本。

## 励志语录与频道管理

- 支持多渠道语录来源，并可调整刷新间隔。
- 在线渠道已精简为文学、诗词、哲学与抖机灵。

## 课程表管理

- 在设置面板中进行课程表的增删改，数据保存在本地存储。
- 适用于校园投屏与固定课时的自习场景。

## PWA 安装与离线

- 支持安装到桌面/主屏，离线可用；更新后自动刷新。
- 缓存策略对图片、字体、音频采用独立策略；文档（`/docs/*.md`）使用 NetworkFirst。

## 常见问题（简要）

- 无法定位城市？请检查浏览器定位授权或使用手动刷新。
- 噪音监测无数据？请确认已授权麦克风并在支持的设备上使用。
- HUD 不出现？确认页面未打开模态框，尝试点击页面或按下 `Space/Enter`。
